<mat-drawer-container autosize>
  <mat-drawer #drawer mode="side">
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          Shit
          <div class="float-right"
                  *ngTemplateOutlet="menuButtonTemplate">
          </div>
        </mat-card-title>
      </mat-card-header>

      <mat-card-content class="side-nav-links"
              (click)="drawer.toggle()">
        <ng-container
                *ngTemplateOutlet="navElementsTemplate">
        </ng-container>
      </mat-card-content>
    </mat-card>
  </mat-drawer>
  <div>
    <header>
      <nav>
        <mat-toolbar color="primary" role="heading">
          <mat-toolbar-row class="mat-elevation-z2">
            <ng-container
                    *ngTemplateOutlet="brandingTemplate">
            </ng-container>

            <ng-container *ngIf="!isSmallScreen()" >
              <ng-container
                      *ngTemplateOutlet="navElementsTemplate">
              </ng-container>
            </ng-container>

            <div class="flex-spacer"></div>

            <ng-container *ngTemplateOutlet="menuButtonTemplate"></ng-container>
          </mat-toolbar-row>
        </mat-toolbar>
      </nav>
    </header>

    <ng-content></ng-content>
  </div>
</mat-drawer-container>

<ng-template #brandingTemplate>
  <div id="app-branding" class="mr-3" routerLink="about/changelog">
    <h1>WAH</h1>
    <small>v.{{ appVersion }}</small>
  </div>
</ng-template>

<ng-template #menuButtonTemplate>
  <button *ngIf="isSmallScreen()"
          type="button"
          mat-button
          (click)="drawer.toggle()">
    <fa-icon [icon]="['fas', 'bars']" aria-label="Menu"></fa-icon>
  </button>
</ng-template>

<ng-template #navElementsTemplate>
  <a mat-flat-button
     class="mr-1 ml-1"
     color="primary"
          [routerLinkActiveOptions]="{exact: false}"
     routerLinkActive="mat-accent"
          [matMenuTriggerFor]="dashboardDropdown">Dashboard
  </a>
  <mat-menu #dashboardDropdown="matMenu">
    <a mat-menu-item
       routerLink="dashboard/items"
       routerLinkActive="mat-accent">Items
    </a>
    <a mat-menu-item
       routerLink="dashboard/sellers"
       routerLinkActive="mat-accent">Sellers
    </a>
    <a mat-menu-item
       routerLink="dashboard/ah-summary"
       routerLinkActive="mat-accent">AH summary
    </a>
    <a mat-menu-item
       routerLink="dashboard/tsm"
       routerLinkActive="mat-accent">TSM
    </a>
    <a mat-menu-item
       routerLink="dashboard/manage-dashboards"
       routerLinkActive="mat-accent">Manage
    </a>
  </mat-menu>

  <a mat-flat-button
     class="mr-1 ml-1"
     color="primary"
     routerLink="crafting"
     routerLinkActive="mat-accent">Crafting
  </a>

  <a mat-flat-button
     class="mr-1 ml-1"
     color="primary"
     routerLinkActive="mat-accent"
          [routerLinkActiveOptions]="{exact: false}"
          matBadge="{{numberOfUndercutAuctions | number}}"
     matBadgePosition="after"
     matBadgeColor="accent"
     matBadgeDescription="The number of undercut auctions"
          [matMenuTriggerFor]="auctionsDropdown">Auctions
  </a>
  <mat-menu #auctionsDropdown="matMenu">
    <a mat-menu-item
       routerLink="auctions"
       routerLinkActive="mat-accent">All auctions
    </a>
    <a mat-menu-item
       routerLink="my-auctions"
       routerLinkActive="mat-accent">My auctions
    </a>
  </mat-menu>

  <a mat-flat-button
     class="mr-1 ml-1"
     color="primary"
     routerLinkActive="mat-accent"
          [matMenuTriggerFor]="toolsDropdown">Tools
  </a>
  <mat-menu #toolsDropdown="matMenu">
    <a mat-menu-item
       routerLink="tools/trade-vendor"
       routerLinkActive="mat-accent">Trade vendors
    </a>
    <a mat-menu-item
       routerLink="tools/sellers"
       routerLinkActive="mat-accent">Sellers
    </a>
    <a mat-menu-item
       routerLink="tools/milling-and-prospecting"
       routerLinkActive="mat-accent">Milling & prospecting
    </a>
    <a mat-menu-item
       routerLink="tools/market-reset"
       routerLinkActive="mat-accent">Market reset (WIP)
    </a>
    <a mat-menu-item
       routerLink="tools/reputations"
       routerLinkActive="mat-accent">Reputations
    </a>
  </mat-menu>

  <a mat-flat-button
     class="mr-1 ml-1"
     color="primary"
     routerLink="settings"
     routerLinkActive="mat-accent">Settings
  </a>

  <a mat-flat-button
     class="mr-1 ml-1"
     color="primary"
     routerLink="about"
     routerLinkActive="mat-accent">About
  </a>

  <div class="flex-spacer"></div>

  <wah-shopping-cart></wah-shopping-cart>

  <wah-download></wah-download>

  <wah-theme-select></wah-theme-select>
</ng-template>
